## Основная идея алгоритма

Данный алгоритм определяет обрезанность подокументного скриншота путём анализа его краёв.
В идеально снятом подокументном скриншоте на краях ожидается рамка из белых пикселей.
Данный детектор анализирует края скриншота и, в случае если на краях обнаружено достаточное количество небелых пикселей, предупреждает о возможной проблеме.

Кроме того, есть скриншоты вертикалей видео и картинок, в которых наличие небелых пикселей на краях -- норма.
Для того, чтобы избежать ложных срабатываний, данный алгоритм выделяет области, подозрительные на наличие изображений и допускает наличие большого количества небелых пикселей в этих областях.

## Границы применимости

Подокументные скриншоты, похожие на подокументные скриншоты Яндекс. Ожидается, что в хороших скриншотах количество небелых пикселей на границе пренебрежимо мало.
Детектируется обрезанность как на горизонтальных, так и на вертикальных краях скриншота.

## Известные проблемы

* Если в прокручиваемых элементах есть текст, то детектор выдаёт ложное срабатывание.

* Не всегда обрезанный скриншот имеет текст на границе.

## Описание алгоритма

1. Извлечь канал Value HSV представления изображения и инвертировать его.
 
2. Наложить экспоненциально затухающую с увеличением расстояния до края маску на изображение. Смысл этого следующий: чем дальше от края тёмные пиксели, тем с большей толерантностью мы к ним относимся. Т.е. тёмные пиксели к центре -- абсолютно ок, у самого края -- абсолютно __не__ ок.

3. Для горизонтальных границ посчитать следующие 2 * k статистик: сумма пикселей в первых k и в последних k строках изображения.
 
4. Выдать результат "аномалия", если максимальное значение этой статистики в какой-либо из 2 * k строк превосходит медиану "достаточно тёмных" строк скриншота, домноженную на константу меньше 1. Эта константа определяет чувствительность алгоритма.
 
5. Для вертикальных краёв нужно сначала отсечь строки скриншота, соответствующие изображениям. Для этого производится пороговая обработка строк и выделяется максимальная последовательная группа строк изображения, каждая из которых "достаточно тёмная".
 Если эта группа строк занимает хотя бы треть вертикального подокументного скриншота, то перед нами вертикаль картинок, карт, видео и т.п. Поэтому эту треть мы не учитываем при дальнейшей обработке.
  
6. Далее для вертикальных краёв производится обработка, аналогичная шагам 4-5. 